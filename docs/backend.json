
{
  "entities": {
    "user": {
      "title": "User",
      "description": "Represents a user account in the system.",
      "type": "object",
      "properties": {
        "uid": { "type": "string", "description": "The user's unique ID from Firebase Auth." },
        "email": { "type": "string", "format": "email" },
        "displayName": { "type": "string" },
        "createdAt": { "type": "string", "format": "date-time" },
        "schoolId": { "type": "string", "description": "The ID of the school the user is associated with. Null if none." },
        "schoolRole": { "type": "string", "enum": ["director", "staff", "parent"], "description": "The user's primary role within their school." },
        "linkedStudentIds": { "type": "array", "items": { "type": "string" }, "description": "For parent accounts, the list of associated student IDs." }
      },
      "required": ["uid", "email", "displayName", "createdAt"]
    },
    "school": {
      "title": "School",
      "description": "Represents an educational institution.",
      "type": "object",
      "properties": {
        "name": { "type": "string" },
        "code": { "type": "string", "description": "A short, unique code for joining the school." },
        "directorId": { "type": "string", "description": "The UID of the user who is the director." },
        "createdAt": { "type": "string", "format": "date-time" },
        "settings": {
          "type": "object",
          "properties": {
            "address": { "type": "string" },
            "phone": { "type": "string" },
            "email": { "type": "string" }
          }
        }
      },
      "required": ["name", "code", "directorId", "createdAt"]
    },
    "schoolMember": {
      "title": "School Member",
      "description": "Represents a user's membership within a school.",
      "type": "object",
      "properties": {
        "userId": { "type": "string", "description": "The UID of the user." },
        "role": { "type": "string", "enum": ["director", "teacher", "secretary", "accountant", "parent"] },
        "joinedAt": { "type": "string", "format": "date-time" },
        "permissions": { "type": "array", "items": { "type": "string" } }
      },
      "required": ["userId", "role", "joinedAt"]
    }
  },
  "auth": {
    "providers": ["Google", "Email"]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": { "$ref": "#/entities/user" },
      "description": "Stores basic user profile information, separate from school-specific data."
    },
    "/schools/{schoolId}": {
      "schema": { "$ref": "#/entities/school" },
      "description": "Stores information about a specific school.",
      "subcollections": {
        "members": {
          "path": "members/{userId}",
          "schema": { "$ref": "#/entities/schoolMember" },
          "description": "A list of all users who are members of this school."
        },
        "classes": {
            "path": "classes/{classId}",
            "schema": { "type": "object" },
            "description": "School classes."
        },
        "students": {
            "path": "students/{studentId}",
            "schema": { "type": "object" },
            "description": "Student profiles."
        },
        "teachers": {
            "path": "teachers/{teacherId}",
            "schema": { "type": "object" },
            "description": "Teacher profiles."
        },
        "subjects": {
            "path": "subjects/{subjectId}",
            "schema": { "type": "object" },
            "description": "School subjects."
        },
        "config": {
            "path": "config/{configId}",
            "schema": { "type": "object" },
            "description": "Configuration documents for the school."
        }
      }
    }
  }
}
