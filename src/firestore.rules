
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // Allow public creation for forms
    match /contact_requests/{requestId} {
      allow create: if true;
    }
     match /survey_responses/{responseId} {
      allow create: if true;
    }
    
    // Pour la messagerie, autoriser la lecture d'un document individuel,
    // la création, et le listage d'un nombre limité de documents.
    match /ecoles/{schoolId}/messagerie/{messageId} {
      allow get, write: if request.auth != null;
      allow list: if request.auth != null && request.query.limit <= 10;
    }

    // Allow authenticated users to read and write to any other document.
    // This is a permissive rule for development.
    match /{document=**} {
      allow read, write: if request.auth != null;
    }
  }
}
